(function(){var b="ExtendedCascadingDropDown";function a(){var f="populated",e="populating",d="selectionChanged",b=true,c="change",a=null;Type.registerNamespace("Sys.Extended.UI");Sys.Extended.UI.CascadingDropDownSelectionChangedEventArgs=function(b,a){Sys.Extended.UI.CascadingDropDownSelectionChangedEventArgs.initializeBase(this);this._oldValue=b;this._newValue=a};Sys.Extended.UI.CascadingDropDownSelectionChangedEventArgs.prototype={get_oldValue:function(){return this._oldValue},get_newValue:function(){return this._newValue}};Sys.Extended.UI.CascadingDropDownSelectionChangedEventArgs.registerClass("Sys.Extended.UI.CascadingDropDownSelectionChangedEventArgs",Sys.EventArgs);Sys.Extended.UI.CascadingDropDownBehavior=function(c){var b=this;Sys.Extended.UI.CascadingDropDownBehavior.initializeBase(b,[c]);b._parentControlID=a;b._category=a;b._promptText=a;b._loadingText=a;b._promptValue=a;b._emptyValue=a;b._emptyText=a;b._servicePath=location.pathname;b._serviceMethod=a;b._contextKey=a;b._useContextKey=false;b._parentElement=a;b._changeHandler=a;b._parentChangeHandler=a;b._lastParentValues=a;b._selectedValue=a};Sys.Extended.UI.CascadingDropDownBehavior.prototype={initialize:function(){var d=this;Sys.Extended.UI.CascadingDropDownBehavior.callBaseMethod(d,"initialize");$common.prepareHiddenElementForATDeviceUpdate();var e=d.get_element();d._clearItems();e.CascadingDropDownCategory=d._category;d._changeHandler=Function.createDelegate(d,d._onChange);$addHandler(e,c,d._changeHandler);if(d._parentControlID){d._parentElement=$get(d._parentControlID);!d._parentElement&&Sys.Debug.fail(String.format(Sys.Extended.UI.Resources.CascadingDropDown_NoParentElement,d._parentControlID));if(d._parentElement){e.CascadingDropDownParentControlID=d._parentControlID;d._parentChangeHandler=Function.createDelegate(d,d._onParentChange);$addHandler(d._parentElement,c,d._parentChangeHandler);if(!d._parentElement.childDropDown)d._parentElement.childDropDown=[];d._parentElement.childDropDown.push(d)}}d._onParentChange(a,b)},dispose:function(){var b=this,d=b.get_element();if(b._changeHandler){$removeHandler(d,c,b._changeHandler);b._changeHandler=a}if(b._parentChangeHandler){b._parentElement&&$removeHandler(b._parentElement,c,b._parentChangeHandler);b._parentChangeHandler=a}Sys.Extended.UI.CascadingDropDownBehavior.callBaseMethod(b,"dispose")},_clearItems:function(){var a=this.get_element();while(0<a.options.length)a.remove(0)},_isPopulated:function(){var a=this.get_element().options.length;if(this._promptText)return a>1;else return a>0},_setOptions:function(f,p,j){var d=this;if(!d.get_isInitialized())return;var e=d.get_element();d._clearItems();var k,l="";if(j&&d._loadingText){k=d._loadingText;if(d._selectedValue)l=d._selectedValue}else if(!j&&f&&0==f.length&&a!=d._emptyText){k=d._emptyText;if(d._emptyValue)l=d._emptyValue}else if(d._promptText){k=d._promptText;if(d._promptValue)l=d._promptValue}if(k){var m=new Option(k,l);e.options[e.options.length]=m}var g=a,h=-1;if(f){for(i=0;i<f.length;i++){var q=f[i].name,n=f[i].value;if(f[i].isDefaultValue){h=i;if(d._promptText)h++}var m=new Option(q,n);if(n==d._selectedValue)g=m;e.options[e.options.length]=m}if(g)g.selected=b}if(g)d.set_SelectedValue(e.options[e.selectedIndex].value,e.options[e.selectedIndex].text);else if(!g&&h!=-1){e.options[h].selected=b;d.set_SelectedValue(e.options[h].value,e.options[h].text)}else if(!p&&!g&&!j&&!d._promptText&&e.options.length>0)d.set_SelectedValue(e.options[0].value,e.options[0].text);else!p&&!g&&!j&&d.set_SelectedValue("","");if(e.childDropDown&&!j)for(i=0;i<e.childDropDown.length;i++)e.childDropDown[i]._onParentChange();else if(f&&Sys.Browser.agent!==Sys.Browser.Safari&&Sys.Browser.agent!==Sys.Browser.Opera)if(document.createEvent){var o=document.createEvent("HTMLEvents");o.initEvent(c,b,false);d.get_element().dispatchEvent(o)}else document.createEventObject&&d.get_element().fireEvent("onchange");if(d._loadingText||d._promptText||d._emptyText)e.disabled=!f||0==f.length;d.raisePopulated(Sys.EventArgs.Empty)},_onChange:function(){var b=this;if(!b._isPopulated())return;var a=b.get_element();if(-1!=a.selectedIndex&&!(b._promptText&&0==a.selectedIndex))b.set_SelectedValue(a.options[a.selectedIndex].value,a.options[a.selectedIndex].text);else b.set_SelectedValue("","")},_onParentChange:function(k,i){var c=this,l=c.get_element(),d="",f=c._parentControlID;while(f){var e=$get(f);if(e&&-1!=e.selectedIndex){var g=e.options[e.selectedIndex].value;if(g&&g!=""){d=e.CascadingDropDownCategory+":"+g+";"+d;f=e.CascadingDropDownParentControlID;continue}}break}if(d!=""&&c._lastParentValues==d)return;c._lastParentValues=d;if(d==""&&c._parentControlID){c._setOptions(a,i);return}c._setOptions(a,i,b);if(c._servicePath&&c._serviceMethod){var h=new Sys.CancelEventArgs;c.raisePopulating(h);if(h.get_cancel())return;var j={knownCategoryValues:d,category:c._category};if(c._useContextKey)j.contextKey=c._contextKey;Sys.Net.WebServiceProxy.invoke(c._servicePath,c._serviceMethod,false,j,Function.createDelegate(c,c._onMethodComplete),Function.createDelegate(c,c._onMethodError));$common.updateFormToRefreshATDeviceBuffer()}},_onMethodComplete:function(a){this._setOptions(a)},_onMethodError:function(b){var a=this;if(b.get_timedOut())a._setOptions([a._makeNameValueObject(Sys.Extended.UI.Resources.CascadingDropDown_MethodTimeout)]);else a._setOptions([a._makeNameValueObject(String.format(Sys.Extended.UI.Resources.CascadingDropDown_MethodError,b.get_statusCode()))])},_makeNameValueObject:function(a){return {name:a,value:a}},get_ParentControlID:function(){return this._parentControlID},set_ParentControlID:function(a){if(this._parentControlID!=a){this._parentControlID=a;this.raisePropertyChanged("ParentControlID")}},get_Category:function(){return this._category},set_Category:function(a){if(this._category!=a){this._category=a;this.raisePropertyChanged("Category")}},get_PromptText:function(){return this._promptText},set_PromptText:function(a){if(this._promptText!=a){this._promptText=a;this.raisePropertyChanged("PromptText")}},get_PromptValue:function(){return this._promptValue},set_PromptValue:function(a){if(this._promptValue!=a){this._promptValue=a;this.raisePropertyChanged("PromptValue")}},get_EmptyText:function(){return this._emptyText},set_EmptyText:function(a){if(this._emptyText!=a){this._emptyText=a;this.raisePropertyChanged("EmptyText")}},get_EmptyValue:function(){return this._emptyValue},set_EmptyValue:function(a){if(this._emptyValue!=a){this._emptyValue=a;this.raisePropertyChanged("EmptyValue")}},get_LoadingText:function(){return this._loadingText},set_LoadingText:function(a){if(this._loadingText!=a){this._loadingText=a;this.raisePropertyChanged("LoadingText")}},get_SelectedValue:function(){return this._selectedValue},set_SelectedValue:function(b,c){var a=this;if(a._selectedValue!=b){if(!c){var d=b.indexOf(":::");if(-1!=d){c=b.slice(d+3);b=b.slice(0,d)}}var e=a._selectedValue;a._selectedValue=b;a.raisePropertyChanged("SelectedValue");a.raiseSelectionChanged(new Sys.Extended.UI.CascadingDropDownSelectionChangedEventArgs(e,b))}Sys.Extended.UI.CascadingDropDownBehavior.callBaseMethod(a,"set_ClientState",[a._selectedValue+":::"+c])},get_ServicePath:function(){return this._servicePath},set_ServicePath:function(a){if(this._servicePath!=a){this._servicePath=a;this.raisePropertyChanged("ServicePath")}},get_ServiceMethod:function(){return this._serviceMethod},set_ServiceMethod:function(a){if(this._serviceMethod!=a){this._serviceMethod=a;this.raisePropertyChanged("ServiceMethod")}},get_contextKey:function(){return this._contextKey},set_contextKey:function(c){var a=this;if(a._contextKey!=c){a._contextKey=c;a.set_useContextKey(b);a.raisePropertyChanged("contextKey")}},get_useContextKey:function(){return this._useContextKey},set_useContextKey:function(a){if(this._useContextKey!=a){this._useContextKey=a;this.raisePropertyChanged("useContextKey")}},add_selectionChanged:function(a){this.get_events().addHandler(d,a)},remove_selectionChanged:function(a){this.get_events().removeHandler(d,a)},raiseSelectionChanged:function(b){var a=this.get_events().getHandler(d);a&&a(this,b)},add_populating:function(a){this.get_events().addHandler(e,a)},remove_populating:function(a){this.get_events().removeHandler(e,a)},raisePopulating:function(b){var a=this.get_events().getHandler(e);a&&a(this,b)},add_populated:function(a){this.get_events().addHandler(f,a)},remove_populated:function(a){this.get_events().removeHandler(f,a)},raisePopulated:function(b){var a=this.get_events().getHandler(f);a&&a(this,b)}};Sys.Extended.UI.CascadingDropDownBehavior.registerClass("Sys.Extended.UI.CascadingDropDownBehavior",Sys.Extended.UI.BehaviorBase);Sys.registerComponent(Sys.Extended.UI.CascadingDropDownBehavior,{name:"cascadingDropDown"})}if(window.Sys&&Sys.loader)Sys.loader.registerScript(b,["ExtendedBase","ExtendedCommon","WebServices"],a);else a()})();